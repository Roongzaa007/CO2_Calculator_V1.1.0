<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASHRAE 62.1 Design Calculator - Manual Mode</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            position: relative;
        }
        
        .version-info {
            position: absolute;
            top: 20px;
            right: 30px;
            text-align: right;
            font-size: 0.9em;
            color: #7f8c8d;
            line-height: 1.3;
        }
        
        .version-number {
            font-weight: bold;
            color: #667eea;
        }
        
        .lite-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 5px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }
        
        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 1024px) {
            .calculator-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .container {
                padding: 20px;
                margin: 10px;
                border-radius: 15px;
            }
            
            .version-info {
                position: relative;
                top: 0;
                right: 0;
                text-align: center;
                margin-bottom: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            /* Responsive breakdown grid */
            .input-section div[style*="grid-template-columns: 1fr 1fr 1fr"] {
                display: grid !important;
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }
        }

        .report-section {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            border-radius: 15px;
            color: white;
            text-align: center;
        }
        
        .report-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .report-btn {
            padding: 12px 25px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .report-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 0;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            margin: 0;
            font-size: 1.3em;
        }
        
        .close {
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.8);
            transition: color 0.3s ease;
        }
        
        .close:hover {
            color: white;
        }
        
        .modal-body {
            padding: 30px;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .export-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .export-pdf {
            background: #e74c3c;
            color: white;
        }
        
        .export-excel {
            background: #27ae60;
            color: white;
        }
        
        .export-word {
            background: #3498db;
            color: white;
        }
        
        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .unit-toggle {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            background: #f8f9fa;
            border-radius: 25px;
            padding: 5px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }
        
        .unit-btn {
            padding: 8px 20px;
            border: none;
            background: transparent;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #7f8c8d;
        }
        
        .unit-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
        }
        
        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }
        
        .input-section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
        }
        
        .input-section h3::before {
            content: "üè¢";
            margin-right: 10px;
            font-size: 1.2em;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #34495e;
            font-weight: 600;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }
        
        .unit {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-left: 5px;
        }
        
        .calculate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        /* New improved results sections */
        .results-main {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #27ae60 0%, #2ed573 100%);
            border-radius: 15px;
            color: white;
        }
        
        .results-verification {
            margin-top: 20px;
            padding: 25px;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            border-radius: 15px;
            color: white;
        }
        
        .results-dcv {
            margin-top: 20px;
            padding: 25px;
            background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
            border-radius: 15px;
            color: white;
            display: none;
        }
        
        .results-section h3 {
            margin-bottom: 20px;
            font-size: 1.4em;
            text-align: center;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .result-card {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .result-card h4 {
            margin-bottom: 10px;
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .result-card .value {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .result-card .unit {
            font-size: 0.8em;
            opacity: 0.8;
        }

        .checkbox-option {
            margin: 20px 0;
            padding: 15px;
            background: #e8f4f8;
            border-radius: 10px;
            border-left: 5px solid #3498db;
        }

        .checkbox-option label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-weight: 600;
            color: #2c3e50;
        }

        .checkbox-option input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: 600;
            margin-left: 10px;
        }

        .status-good {
            background: rgba(39, 174, 96, 0.2);
            color: #27ae60;
        }

        .status-warning {
            background: rgba(230, 126, 34, 0.2);
            color: #e67e22;
        }

        .status-poor {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }

        .info-section {
            margin-top: 30px;
            padding: 20px;
            background: #e8f4f8;
            border-radius: 10px;
            border-left: 5px solid #3498db;
        }
        
        .info-section h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .info-section ul {
            color: #34495e;
            padding-left: 20px;
        }
        
        .info-section li {
            margin-bottom: 5px;
        }

        .ashrae-breakdown {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .breakdown-card {
            background: #ffffff;
            padding: 15px;
            border-radius: 8px;
            font-size: 0.9em;
            border: 2px solid #e3f2fd;
            color: #2c3e50;
        }

        .breakdown-card h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .breakdown-total {
            border-top: 2px solid #1976d2;
            margin-top: 12px;
            padding-top: 12px;
            font-weight: bold;
            color: #1976d2;
            font-size: 1.1em;
        }

        .report-template {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #2c3e50;
        }
        
        .report-header {
            text-align: center;
            border-bottom: 3px solid #667eea;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .report-title {
            font-size: 1.8em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .report-subtitle {
            color: #7f8c8d;
            font-size: 1.1em;
        }
        
        .report-meta {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .report-section-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
            margin: 25px 0 15px 0;
            padding-bottom: 8px;
            border-bottom: 2px solid #ecf0f1;
        }
        
        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .report-table th,
        .report-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .report-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }
        
        .report-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .report-table tr:hover {
            background-color: #e3f2fd;
        }

        .watermark {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .modal-content {
                width: 95%;
                margin: 5% auto;
            }
            
            .modal-body {
                padding: 20px;
            }
            
            .report-meta {
                grid-template-columns: 1fr;
            }
            
            .report-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .export-buttons {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="version-info">
            <div class="version-number">Version 1.1.0<span class="lite-badge">LITE</span></div>
            <div>26 July 2025</div>
        </div>

        <div class="report-section" id="reportSection" style="display: none;">
            <h3>üìÑ Generate Professional Report</h3>
            <p>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠</p>
            <div class="report-buttons">
                <button class="report-btn" onclick="generateReport()">
                    üìä Preview Report
                </button>
                <button class="report-btn" onclick="exportToPDF()">
                    üìÑ Export PDF
                </button>
                <button class="report-btn" onclick="exportToExcel()">
                    üìà Export Excel
                </button>
                <button class="report-btn" onclick="exportToWord()">
                    üìù Export Word
                </button>
                <button class="report-btn" onclick="showAbout()">
                    ‚ÑπÔ∏è About & Features
                </button>
            </div>
        </div>

        <!-- About Modal -->
        <div id="aboutModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>‚ÑπÔ∏è About ASHRAE 62.1 Calculator</h3>
                    <span class="close" onclick="closeAbout()">&times;</span>
                </div>
                <div class="modal-body">
                    <div style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #2c3e50;">
                        <h4 style="color: #667eea; margin-bottom: 15px;">üìã ASHRAE 62.1-2022 Calculator v1.1.0 - LITE Edition</h4>
                        <ul style="padding-left: 20px; margin-bottom: 25px;">
                            <li><strong>Updated Space Types:</strong> ‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ASHRAE Standard 62.1 (Calculations-of-Ventilation-Rate)</li>
                            <li><strong>Occupant Density Guide:</strong> ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á (‡∏Ñ‡∏ô/100m¬≤)</li>
                            <li><strong>Combined Outdoor Rate:</strong> ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤ Combined OA Rate ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (L/s¬∑person)</li>
                            <li><strong>Air Class Rating:</strong> ‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏® (1=‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î, 2=‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á, 3=‡∏û‡∏¥‡πÄ‡∏®‡∏©)</li>
                            <li><strong>CO2 Calculation:</strong> ASHRAE 62.1-2022 Appendix C: CR = COA + (8400 √ó Ez √ó m) / (Rp + Ra √ó Az/Pz)</li>
                            <li><strong>Metabolic Rate:</strong> 1.0 met (Sedentary), 1.2 met (Light), 2.0 met (Moderate), 3.0 met (Heavy)</li>
                            <li><strong>Standards Reference:</strong> EN 16798-1, WHO, ASHRAE, LEED v4.1, WELL Building</li>
                            <li><strong>Professional Reports:</strong> üìÑ Generate comprehensive calculation reports with project details</li>
                            <li><strong>Export Options:</strong> üìà CSV export (LITE) | üìÑ PDF, Excel, Word (PRO upgrade)</li>
                            <li><strong>Dual Unit System:</strong> SI (‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å) ‡πÅ‡∏•‡∏∞ I-P (‡∏≠‡∏¥‡∏°‡∏û‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏•) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</li>
                            <li><strong>Recommended OA:</strong> ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á ASHRAE 62.1 ‡πÅ‡∏•‡∏∞ CO2-based requirements</li>
                            <li><strong>ASHRAE 62.1 Compliance:</strong> ‡∏ï‡∏≤‡∏° Table 6.2.2.1 ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Rp + Ra</li>
                            <li><strong>Mobile Responsive:</strong> ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</li>
                            <li><strong>Color Coding:</strong> üü¢ ‚â§800ppm ‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° | üü° ‚â§1000ppm ‡∏î‡∏µ | üü† ‚â§1200ppm ‡∏û‡∏≠‡πÉ‡∏ä‡πâ | üî¥ >1200ppm ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</li>
                            <li><strong>LITE Features:</strong> ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô, 40+ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà, Unit Conversion, Report Preview</li>
                            <li><strong>PRO Upgrade:</strong> üíº PDF Reports, Excel Charts, Multi-zone, API Access, Team Collaboration</li>
                        </ul>
                        
                        <h4 style="color: #667eea; margin: 25px 0 15px 0;">üéØ CO2 Target Selection Guide</h4>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                            <table style="width: 100%; font-size: 0.9em;">
                                <tr style="background: #667eea; color: white;">
                                    <th style="padding: 8px; text-align: left;">Building Type</th>
                                    <th style="padding: 8px; text-align: center;">Target CO2</th>
                                    <th style="padding: 8px; text-align: left;">Standard</th>
                                </tr>
                                <tr><td style="padding: 5px;">üè• Hospital/Healthcare</td><td style="padding: 5px; text-align: center;">600-800 ppm</td><td style="padding: 5px;">Patient safety</td></tr>
                                <tr style="background: #f8f9fa;"><td style="padding: 5px;">üéì Schools/Education</td><td style="padding: 5px; text-align: center;">800 ppm</td><td style="padding: 5px;">EN 16798-1 Cat I</td></tr>
                                <tr><td style="padding: 5px;">üè¢ Premium Office</td><td style="padding: 5px; text-align: center;">800 ppm</td><td style="padding: 5px;">LEED/WELL</td></tr>
                                <tr style="background: #f8f9fa;"><td style="padding: 5px;">üè¢ Standard Office</td><td style="padding: 5px; text-align: center;">1000 ppm</td><td style="padding: 5px;">WHO Guidelines</td></tr>
                                <tr><td style="padding: 5px;">üè™ Retail/Commercial</td><td style="padding: 5px; text-align: center;">1000 ppm</td><td style="padding: 5px;">General use</td></tr>
                                <tr style="background: #f8f9fa;"><td style="padding: 5px;">üçΩÔ∏è Restaurant</td><td style="padding: 5px; text-align: center;">1000-1200 ppm</td><td style="padding: 5px;">High density</td></tr>
                                <tr><td style="padding: 5px;">üèãÔ∏è Gym/Fitness</td><td style="padding: 5px; text-align: center;">1200 ppm</td><td style="padding: 5px;">Heavy activity</td></tr>
                            </table>
                        </div>
                        
                        <h4 style="color: #667eea; margin: 25px 0 15px 0;">üìö Standards & Certifications</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                                <h5 style="margin-bottom: 10px; color: #1976d2;">üåç International Standards</h5>
                                <ul style="font-size: 0.9em; margin: 0;">
                                    <li><strong>EN 16798-1:</strong> European standard</li>
                                    <li><strong>WHO:</strong> ‚â§ 1000 ppm recommended</li>
                                    <li><strong>ASHRAE 62.1:</strong> Ventilation baseline</li>
                                    <li><strong>ISO 17772-1:</strong> Energy performance</li>
                                </ul>
                            </div>
                            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px;">
                                <h5 style="margin-bottom: 10px; color: #388e3c;">üèÜ Green Certifications</h5>
                                <ul style="font-size: 0.9em; margin: 0;">
                                    <li><strong>LEED v4.1:</strong> ‚â§ 1000 ppm above outdoor</li>
                                    <li><strong>WELL Building:</strong> ‚â§ 800 ppm above outdoor</li>
                                    <li><strong>BREEAM:</strong> ‚â§ 800 ppm (Excellent)</li>
                                    <li><strong>Thai TGBI:</strong> ‚â§ 800 ppm (Gold)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="reportModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üìä HVAC Calculation Report</h3>
                    <span class="close" onclick="closeReport()">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="report-template" id="reportContent">
                        <!-- Report content will be generated here -->
                    </div>
                    <div class="export-buttons">
                        <button class="export-btn export-pdf" onclick="exportToPDF()">
                            üìÑ Export PDF
                        </button>
                        <button class="export-btn export-excel" onclick="exportToExcel()">
                            üìà Export Excel
                        </button>
                        <button class="export-btn export-word" onclick="exportToWord()">
                            üìù Export Word
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="header">
            <h1>ASHRAE 62.1 Design Calculator</h1>
            <p>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ASHRAE 62.1 ‡∏û‡∏£‡πâ‡∏≠‡∏° CO2 Verification</p>
        </div>
        
        <div class="unit-toggle">
            <button class="unit-btn active" id="siBtn" onclick="toggleUnit('SI')">SI (‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å)</button>
            <button class="unit-btn" id="ipBtn" onclick="toggleUnit('IP')">I-P (‡∏≠‡∏¥‡∏°‡∏û‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏•)</button>
        </div>
        
        <div class="calculator-grid">
            <div class="input-section">
<h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ (Building Information)</h3>
                
                <div class="form-group">
                    <label for="spaceType">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (Space Type): <strong style="color: #e74c3c;">78 ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</strong></label>
                    <select id="spaceType">
                        <optgroup label="üèõÔ∏è ‡∏ó‡∏±‡∏ì‡∏ë‡∏™‡∏ñ‡∏≤‡∏ô (Correctional Facilities)">
                            <option value="cell">‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏∏‡∏°‡∏Ç‡∏±‡∏á‡∏ô‡∏±‡∏Å‡πÇ‡∏ó‡∏© (Cell)</option>
                            <option value="dayroom">‡∏´‡πâ‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£ (Dayroom)</option>
                            <option value="guard_stations">‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤‡∏° (Guard Stations)</option>
                            <option value="booking_waiting">‡∏´‡πâ‡∏≠‡∏á‡∏£‡∏≠ (Booking/Waiting)</option>
                        </optgroup>
                        
                        <optgroup label="üìö ‡∏™‡∏ñ‡∏≤‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤ (Educational Facilities)">
                            <option value="daycare_age4">‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πá‡∏Å ‡∏≠‡∏≤‡∏¢‡∏∏ 4 ‡∏Ç‡∏ß‡∏ö (Daycare through age 4)</option>
                            <option value="daycare_sickroom">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏î‡πá‡∏Å‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πá‡∏Å (Daycare Sickroom)</option>
                            <option value="classroom_age5to8">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏≠‡∏≤‡∏¢‡∏∏ 5-8 ‡∏õ‡∏µ (Classrooms ages 5-8)</option>
                            <option value="classroom_age9plus">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏≠‡∏≤‡∏¢‡∏∏‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà 9 ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ (Classrooms age 9 plus)</option>
                            <option value="lecture_classroom">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà (Lecture Classroom)</option>
                            <option value="lecture_hall_fixed">‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà (Lecture Hall Fixed Seats)</option>
                            <option value="art_classroom">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏®‡∏¥‡∏•‡∏õ‡∏∞ (Art Classroom)</option>
                            <option value="science_laboratories">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (Science Laboratories)</option>
                            <option value="university_laboratories">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢ (University/College Laboratories)</option>
                            <option value="wood_metal_shop">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≤‡∏á‡πÑ‡∏°‡πâ‡πÇ‡∏•‡∏´‡∏∞ (Wood/Metal Shop)</option>
                            <option value="computer_lab">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå (Computer Lab)</option>
                            <option value="media_center">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏∑‡πà‡∏≠ (Media Center)</option>
                            <option value="music_theater_dance">‡∏´‡πâ‡∏≠‡∏á‡∏î‡∏ô‡∏ï‡∏£‡∏µ/‡∏•‡∏∞‡∏Ñ‡∏£/‡πÄ‡∏ï‡πâ‡∏ô‡∏£‡∏≥ (Music/Theater/Dance)</option>
                            <option value="multiuse_assembly">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡πÄ‡∏ô‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå (Multiuse Assembly)</option>
                        </optgroup>
                        
                        <optgroup label="üçΩÔ∏è ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏° (Food and Beverage Service)">
                            <option value="restaurant_dining">‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡πà‡∏á‡∏Å‡∏¥‡∏ô (Restaurant Dining Rooms)</option>
                            <option value="cafeteria_fastfood">‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£/‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏£‡πá‡∏ß (Cafeteria/Fast-food Dining)</option>
                            <option value="bars_cocktail_lounges">‡∏ö‡∏≤‡∏£‡πå ‡∏ú‡∏±‡∏ö ‡πÄ‡∏•‡∏≤‡∏ô‡πå‡∏à (Bars, Cocktail Lounges)</option>
                            <option value="kitchen_cooking">‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ß (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£) (Kitchen Cooking)</option>
                        </optgroup>
                        
                        <optgroup label="üèóÔ∏è ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (General)">
                            <option value="break_rooms">‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô (Break Rooms)</option>
                            <option value="coffee_stations">‡∏°‡∏∏‡∏°‡∏Å‡∏≤‡πÅ‡∏ü (Coffee Stations)</option>
                            <option value="conference_meeting">‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏±‡∏°‡∏°‡∏ô‡∏≤/‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° (Conference/Meeting)</option>
                            <option value="corridors">‡πÇ‡∏ñ‡∏á‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô (Corridors)</option>
                            <option value="occupable_storage_liquids">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏à‡∏• (Occupable Storage Rooms for Liquids or Gels)</option>
                        </optgroup>
                        
                        <optgroup label="üè® ‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏° ‡πÇ‡∏°‡πÄ‡∏ï‡πá‡∏• ‡∏£‡∏µ‡∏™‡∏≠‡∏£‡πå‡∏ó ‡∏´‡∏≠‡∏û‡∏±‡∏Å (Hotels, Motels, Resorts, Dormitories)">
                            <option value="bedroom_living_room">‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô/‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏±‡πà‡∏á‡πÄ‡∏•‡πà‡∏ô (Bedroom/Living Room)</option>
                            <option value="barracks_sleeping">‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô‡∏£‡∏ß‡∏° (Barracks Sleeping Areas)</option>
                            <option value="laundry_rooms_central">‡∏´‡πâ‡∏≠‡∏á‡∏ã‡∏±‡∏Å‡∏£‡∏µ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á (Laundry Rooms, Central)</option>
                            <option value="laundry_rooms_dwelling">‡∏´‡πâ‡∏≠‡∏á‡∏ã‡∏±‡∏Å‡∏£‡∏µ‡∏î‡πÉ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å‡∏≠‡∏≤‡∏®‡∏±‡∏¢ (Laundry Rooms within Dwelling Units)</option>
                            <option value="lobbies_prefunction">‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏ñ‡∏á‡∏£‡∏±‡∏ö‡πÅ‡∏Ç‡∏Å/‡∏´‡πâ‡∏≠‡∏á‡∏£‡∏≠ (Lobbies/Prefunction)</option>
                            <option value="multipurpose_assembly">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡πÄ‡∏ô‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå (Multipurpose Assembly)</option>
                        </optgroup>
                        
                        <optgroup label="üè¢ ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (Office Buildings)">
                            <option value="breakrooms_office">‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å‡πÉ‡∏ô‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (Breakrooms)</option>
                            <option value="main_entry_lobbies">‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏ñ‡∏á‡∏ó‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å (Main Entry Lobbies)</option>
                            <option value="occupable_storage_dry">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡πÅ‡∏´‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Occupable Storage Rooms for Dry Materials)</option>
                            <option value="office_space" selected>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (Office Space)</option>
                            <option value="reception_areas">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÅ‡∏Ç‡∏Å‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö (Reception Areas)</option>
                            <option value="telephone_data_entry">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå/‡∏õ‡πâ‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Telephone/Data Entry)</option>
                        </optgroup>
                        
                        <optgroup label="üîß ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏ï‡∏•‡πá‡∏î (Miscellaneous Spaces)">
                            <option value="bank_vaults">‡∏ï‡∏π‡πâ‡∏ô‡∏¥‡∏£‡∏†‡∏±‡∏¢‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ (Bank Vaults/Safe Deposit)</option>
                            <option value="banks_lobbies">‡πÇ‡∏ñ‡∏á‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ (Banks or Bank Lobbies)</option>
                            <option value="computer_not_printing">‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå) (Computer Not Printing)</option>
                            <option value="freezer_refrigerated">‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á (<10¬∞ C) (Freezer and Refrigerated Spaces)</option>
                            <option value="general_manufacturing">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (General Manufacturing)</option>
                            <option value="pharmacy_prep">‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏° (‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏¢‡∏≤) (Pharmacy Prep Area)</option>
                            <option value="photo_studios">‡∏™‡∏ï‡∏π‡∏î‡∏¥‡πÇ‡∏≠‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û (Photo Studios)</option>
                            <option value="shipping_receiving">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Shipping/Receiving)</option>
                            <option value="sorting_packing">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å ‡∏ö‡∏£‡∏£‡∏à‡∏∏ ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö (Sorting, Packing, Light Assembly)</option>
                            <option value="telephone_closets">‡∏ï‡∏π‡πâ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (Telephone Closets)</option>
                            <option value="transportation_waiting">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á (Transportation Waiting)</option>
                            <option value="warehouses">‡πÇ‡∏Å‡∏î‡∏±‡∏á (Warehouses)</option>
                        </optgroup>
                        
                        <optgroup label="üé≠ ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏∏‡∏°‡∏ô‡∏∏‡∏°‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞ (Public Assembly Spaces)">
                            <option value="auditorium_seating">‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡∏°‡∏µ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î (Auditorium Seating Area)</option>
                            <option value="places_religious_worship">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏®‡∏≤‡∏™‡∏ô‡∏Å‡∏¥‡∏à (Places of Religious Worship)</option>
                            <option value="courtrooms">‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Ñ‡∏î‡∏µ (Courtrooms)</option>
                            <option value="legislative_chambers">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥ (Legislative Chambers)</option>
                            <option value="libraries">‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î (Libraries)</option>
                            <option value="lobbies_public">‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏ñ‡∏á‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞ (Lobbies)</option>
                            <option value="museums_children">‡∏û‡∏¥‡∏û‡∏¥‡∏ò‡∏†‡∏±‡∏ì‡∏ë‡πå (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡πá‡∏Å) (Museums Children's)</option>
                            <option value="museums_galleries">‡∏û‡∏¥‡∏û‡∏¥‡∏ò‡∏†‡∏±‡∏ì‡∏ë‡πå/‡∏´‡∏≠‡∏®‡∏¥‡∏•‡∏õ‡πå (Museums/Galleries)</option>
                        </optgroup>
                        
                        <optgroup label="üè† ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢ (Residential)">
                            <option value="dwelling_unit">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢ (Dwelling Unit)</option>
                            <option value="common_corridors">‡πÇ‡∏ñ‡∏á‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡πà‡∏ß‡∏° (Common Corridors)</option>
                        </optgroup>
                        
                        <optgroup label="üõçÔ∏è ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ (Retail)">
                            <option value="sales_except_below">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏•‡πà‡∏≤‡∏á) (Sales Except as Below)</option>
                            <option value="mall_common_areas">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏´‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏û‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Mall Common Areas)</option>
                            <option value="barbershop">‡∏£‡πâ‡∏≤‡∏ô‡∏ï‡∏±‡∏î‡∏ú‡∏° (Barbershop)</option>
                            <option value="beauty_nail_salons">‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏ß‡∏¢‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÄ‡∏•‡πá‡∏ö (Beauty and Nail Salons)</option>
                            <option value="pet_shops">‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á (Pet Shops Animal Areas)</option>
                            <option value="supermarket">‡∏ã‡∏∏‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡∏°‡∏≤‡∏£‡πå‡πÄ‡∏Å‡πá‡∏ï (Supermarket)</option>
                            <option value="coin_operated_laundries">‡∏£‡πâ‡∏≤‡∏ô‡∏ã‡∏±‡∏Å‡∏ú‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏´‡∏¢‡∏≠‡∏î‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç (Coin-operated Laundries)</option>
                        </optgroup>
                        
                        <optgroup label="üèÉ‚Äç‚ôÇÔ∏è ‡∏Å‡∏µ‡∏¨‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á (Sports and Entertainment)">
                            <option value="gym_sports_arena">‡∏´‡πâ‡∏≠‡∏á‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢, ‡∏™‡∏ô‡∏≤‡∏°‡∏Å‡∏µ‡∏¨‡∏≤ (Gym, Sports Arena Play Area)</option>
                            <option value="spectator_area">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡∏ä‡∏°‡∏ú‡∏π‡πâ‡∏ä‡∏° (Spectator Area)</option>
                            <option value="swimming_pool_deck">‡∏™‡∏£‡∏∞‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô‡πÄ‡∏î‡∏Å (Swimming Pool & Deck)</option>
                            <option value="disco_dance_floors">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡πâ‡∏ô‡∏£‡∏≥‡πÉ‡∏ô‡∏î‡∏¥‡∏™‡πÇ‡∏Å‡πâ (Disco/Dance Floors)</option>
                            <option value="health_club_aerobics">‡πÄ‡∏Æ‡∏•‡∏ó‡πå‡∏Ñ‡∏•‡∏±‡∏ö ‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏≠‡πÇ‡∏£‡∏ö‡∏¥‡∏Ñ (Health Club/Aerobics Room)</option>
                            <option value="health_club_weight_rooms">‡πÄ‡∏Æ‡∏•‡∏ó‡πå‡∏Ñ‡∏•‡∏±‡∏ö ‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏Å‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (Health Club/Weight Rooms)</option>
                            <option value="bowling_alley_seating">‡πÇ‡∏ö‡∏ß‡πå‡∏•‡∏¥‡πà‡∏á (‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á) (Bowling Alley Seating)</option>
                            <option value="gambling_casinos">‡∏Ñ‡∏≤‡∏™‡∏¥‡πÇ‡∏ô (Gambling Casinos)</option>
                            <option value="game_arcades">‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏Å‡∏° (Game Arcades)</option>
                            <option value="stages_studios">‡πÄ‡∏ß‡∏ó‡∏µ‡πÅ‡∏•‡∏∞‡∏™‡∏ï‡∏π‡∏î‡∏¥‡πÇ‡∏≠ (Stages, Studios)</option>
                        </optgroup>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="width">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á (Width): <span class="unit" id="widthUnit">m</span></label>
                    <input type="number" id="width" value="10" min="1" step="0.1">
                </div>
                
                <div class="form-group">
                    <label for="length">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß (Length): <span class="unit" id="lengthUnit">m</span></label>
                    <input type="number" id="length" value="10" min="1" step="0.1">
                </div>
                
                <div class="form-group">
                    <label>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏° (Total Area): <span class="unit" id="areaUnit">m¬≤</span></label>
                    <input type="text" id="calculatedArea" value="100" readonly style="background-color: #e9ecef; color: #6c757d;">
                </div>
                
                <div class="form-group">
                    <label for="occupancy">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Occupancy): <span class="unit">‡∏Ñ‡∏ô</span></label>
                    <input type="number" id="occupancy" value="20" min="1">
                    <div style="font-size: 0.85em; color: #7f8c8d; margin-top: 5px;">
                        <strong>üèóÔ∏è Occupant Density ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> 
                        <span id="recommendedDensity" style="color: #667eea; font-weight: bold;">50 ‡∏Ñ‡∏ô/100m¬≤</span>
                        <br><span style="font-size: 0.8em;">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà <span id="currentSpaceType">100 m¬≤</span> = <span id="suggestedOccupancy" style="color: #e67e22; font-weight: bold;">50 ‡∏Ñ‡∏ô</span></span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="ceilingHeight">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÄ‡∏û‡∏î‡∏≤‡∏ô (Ceiling Height): <span class="unit" id="heightUnit">m</span></label>
                    <input type="number" id="ceilingHeight" value="3" min="2" step="0.1">
                </div>
            </div>
            
            <div class="input-section">
                <h3>‚öôÔ∏è CO2 Verification Parameters</h3>
                
                <div class="form-group">
                    <label for="targetCO2">Target CO2 Level: <span class="unit">ppm</span></label>
                    <input type="number" id="targetCO2" value="1000" min="500" max="1500" step="50">
                    <div style="font-size: 0.85em; color: #7f8c8d; margin-top: 5px;">
                        <strong>‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> 
                        <span style="cursor: pointer; color: #667eea;" onclick="setTargetCO2(800)">800 ppm (Premium)</span> | 
                        <span style="cursor: pointer; color: #667eea;" onclick="setTargetCO2(1000)">1000 ppm (Standard)</span> | 
                        <span style="cursor: pointer; color: #667eea;" onclick="setTargetCO2(1200)">1200 ppm (Minimum)</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="outdoorCO2">Outdoor CO2 Concentration: <span class="unit">ppm</span></label>
                    <input type="number" id="outdoorCO2" value="400" min="300" max="500">
                </div>
                
                <div class="form-group">
                    <label for="ventilationEff">Ventilation Effectiveness:</label>
                    <input type="number" id="ventilationEff" value="1.0" min="0.5" max="1.5" step="0.1">
                </div>
                
                <div class="form-group">
                    <label for="activityLevel">Activity Level:</label>
                    <select id="activityLevel">
                        <option value="sedentary">‡∏ô‡∏±‡πà‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Sedentary)</option>
                        <option value="light">‡∏á‡∏≤‡∏ô‡πÄ‡∏ö‡∏≤ (Light Activity)</option>
                        <option value="moderate">‡∏á‡∏≤‡∏ô‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á (Moderate Activity)</option>
                        <option value="heavy">‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏Å (Heavy Activity)</option>
                    </select>
                </div>

                <div class="checkbox-option">
                    <label>
                        <input type="checkbox" id="enableDCV">
                        üîß Enable DCV Analysis (Demand Controlled Ventilation)
                    </label>
                </div>
            </div>
        </div>
        
        <!-- ASHRAE 62.1 Breakdown Section -->
        <div class="input-section" style="margin-top: 20px;">
            <h3>üå¨Ô∏è ASHRAE 62.1 Requirements Breakdown</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                <div class="breakdown-card">
                    <h4>Rp - People Component:</h4>
                    <div style="margin-bottom: 8px;"><strong>Rate:</strong> <span id="rpRate">-</span> L/s¬∑person</div>
                    <div style="margin-bottom: 8px;"><strong>People:</strong> <span id="peopleCount">-</span> persons</div>
                    <div style="margin-bottom: 8px;"><strong>Required:</strong> <span id="rpValue" style="color: #1976d2; font-weight: bold;">-</span> <span id="rpUnit">L/s</span></div>
                </div>
                <div class="breakdown-card">
                    <h4>Ra - Area Component:</h4>
                    <div style="margin-bottom: 8px;"><strong>Rate:</strong> <span id="raRate">-</span> L/s¬∑m¬≤</div>
                    <div style="margin-bottom: 8px;"><strong>Area:</strong> <span id="areaSize">-</span> m¬≤</div>
                    <div style="margin-bottom: 8px;"><strong>Required:</strong> <span id="raValue" style="color: #1976d2; font-weight: bold;">-</span> <span id="raUnit">L/s</span></div>
                </div>
                <div class="breakdown-card">
                    <h4>üìä Space Parameters:</h4>
                    <div style="margin-bottom: 8px;"><strong>Occupant Density:</strong> <span id="standardDensity">-</span> ‡∏Ñ‡∏ô/100m¬≤</div>
                    <div style="margin-bottom: 8px;"><strong>Combined OA:</strong> <span id="combinedRate">-</span> L/s¬∑person</div>
                    <div style="margin-bottom: 8px;"><strong>Air Class:</strong> <span id="airClass" style="color: #1976d2; font-weight: bold;">-</span></div>
                </div>
            </div>
            <div class="breakdown-total">
                ASHRAE 62.1 Total Required: <span id="totalRequired">-</span> <span id="totalReqUnit">L/s</span>
            </div>
            <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 8px; font-size: 0.9em;">
                <strong>üßÆ CO2 Formula :</strong><br>
                CR = COA + (8400 √ó Ez √ó m) / (Rp + Ra √ó Az/Pz)<br>
                <span style="font-size: 0.8em; color: #666;">
                    CR=Indoor CO2, COA=Outdoor CO2, Ez=Ventilation Effectiveness, m=Metabolic Rate (met)
                </span>
            </div>
        </div>
        
        <button class="calculate-btn" onclick="calculateAndScroll()">üßÆ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≤‡∏° ASHRAE 62.1 + CO2 Verification</button>
        
        <!-- Main Design Results (ASHRAE 62.1) -->
        <div class="results-main" id="resultsMain" style="display: none;">
            <h3>üìã ASHRAE 62.1 Design Results (Primary)</h3>
            <div class="results-grid">
                <div class="result-card">
                    <h4>üéØ Recommended OA Rate</h4>
                    <div class="value" id="designOA">-</div>
                    <div class="unit" id="resultOAUnit">L/s</div>
                </div>
                
                <div class="result-card">
                    <h4>üí® Air Changes per Hour</h4>
                    <div class="value" id="airChanges">-</div>
                    <div class="unit">ACH</div>
                </div>
                
                <div class="result-card">
                    <h4>üì¶ Room Volume</h4>
                    <div class="value" id="roomVolume">-</div>
                    <div class="unit" id="volumeUnit">m¬≥</div>
                </div>

                <div class="result-card">
                    <h4>üë• Occupancy Density</h4>
                    <div class="value" id="occupancyDensity">-</div>
                    <div class="unit" id="densityUnit">m¬≤/person</div>
                </div>
            </div>
        </div>

        <!-- CO2 Verification Results -->
        <div class="results-verification" id="resultsVerification" style="display: none;">
            <h3>üîç CO2 Verification & IAQ Analysis</h3>
            <div class="results-grid">
                <div class="result-card">
                    <h4>üè≠ Metabolic Rate</h4>
                    <div class="value" id="metabolicRate">-</div>
                    <div class="unit">met</div>
                </div>
                
                <div class="result-card">
                    <h4>üí® Total CO2 Generation</h4>
                    <div class="value" id="co2Generation">-</div>
                    <div class="unit">mL/s</div>
                </div>
                
                <div class="result-card">
                    <h4>üå°Ô∏è Predicted Indoor CO2</h4>
                    <div class="value" id="indoorCO2">-</div>
                    <div class="unit">ppm</div>
                    <div id="co2Status" class="status-indicator">-</div>
                </div>

                <div class="result-card">
                    <h4>‚úÖ IAQ Performance</h4>
                    <div class="value" id="iaqRating">-</div>
                    <div class="unit">Rating</div>
                </div>

                <div class="result-card">
                    <h4>üí° DCV Recommendation</h4>
                    <div class="value" id="dcvRecommendation">-</div>
                    <div class="unit">Status</div>
                </div>
            </div>
        </div>

        <!-- DCV Analysis (Optional) -->
        <div class="results-dcv" id="resultsDCV">
            <h3>‚öôÔ∏è DCV System Design Analysis</h3>
            <div class="results-grid">
                <div class="result-card">
                    <h4>üéõÔ∏è CO2-based Minimum OA</h4>
                    <div class="value" id="co2BasedOA">-</div>
                    <div class="unit" id="dcvOAUnit">L/s</div>
                </div>
                
                <div class="result-card">
                    <h4>‚ö° Potential Energy Savings</h4>
                    <div class="value" id="energySavings">-</div>
                    <div class="unit">%</div>
                </div>

                <div class="result-card">
                    <h4>üéØ Recommended CO2 Setpoint</h4>
                    <div class="value" id="co2Setpoint">-</div>
                    <div class="unit">ppm</div>
                </div>

                <div class="result-card">
                    <h4>üìä OA Range</h4>
                    <div class="value" id="oaRange">-</div>
                    <div class="unit" id="rangeUnit">L/s</div>
                </div>
            </div>
        </div>
        
        <div class="info-section">
            <h4>üìã ASHRAE 62.1-2022 Design Calculator v1.1.0 - LITE Edition</h4>
            <ul>
                <li><strong>Design Philosophy:</strong> ASHRAE 62.1 ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏Å, CO2 ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ verify ‡πÅ‡∏•‡∏∞ DCV planning</li>
                <li><strong>Primary Standard:</strong> ASHRAE 62.1-2022 Table 6.2.2.1 (Rp + Ra Method)</li>
                <li><strong>CO2 Calculation:</strong> ‡πÇ‡∏î‡∏¢ CR = COA + (8400 √ó Ez √ó m) / (Rp + Ra √ó Az/Pz)</li>
                <li><strong>Metabolic Rate:</strong> ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å Activity Level (1.0-3.0 met)</li>
                <li><strong>DCV Analysis:</strong> ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Demand Controlled Ventilation</li>
                <li><strong>Color Coding:</strong> üü¢ ‚â§800ppm ‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° | üü° ‚â§1000ppm ‡∏î‡∏µ | üü† ‚â§1200ppm ‡∏û‡∏≠‡πÉ‡∏ä‡πâ | üî¥ >1200ppm ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</li>
            </ul>
        </div>
        
        <div style="text-align: center; margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; color: white;">
            <h4 style="margin-bottom: 15px; font-size: 1.2em;">üíù Social Impact</h4>
            <p style="font-size: 1.1em; font-weight: 600; margin-bottom: 12px;">
                ‡∏Å‡∏£‡∏∞‡∏ú‡∏° <strong>‡∏ô‡∏≤‡∏¢ ‡∏à‡∏¥‡∏£‡∏≤‡πÄ‡∏°‡∏ò ‡πÇ‡∏õ‡∏ï‡∏¥‡πä‡∏ö</strong> ‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤ ‡∏Ç‡∏≠‡∏°‡∏≠‡∏ö<br>
                <strong>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° ‡πÅ‡∏•‡∏∞‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏ô‡∏¥‡∏™‡∏¥‡∏ï‡∏Ç‡∏≤‡∏î‡πÅ‡∏Ñ‡∏•‡∏ô‡∏ó‡∏∏‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå</strong>
            </p>
            <p style="font-size: 0.95em; font-weight: 600; margin-bottom: 15px; background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px;">
                <strong>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: 020471108728 ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡∏™‡∏¥‡∏ô<br>
                ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: ‡πÇ‡∏Ñ‡∏£‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏®<br>
                ‡∏ô‡πâ‡∏≠‡∏á‡πÜ ASHRAE SBA ‡∏°.‡∏û‡∏∞‡πÄ‡∏¢‡∏≤</strong>
            </p>
            <p style="font-size: 0.9em; opacity: 0.9; margin-bottom: 20px;">
                Supporting education and activities through technology
            </p>
            <p style="font-size: 0.95em; border-top: 1px solid rgba(255,255,255,0.3); padding-top: 15px;">
                <strong>‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢:</strong> roongzaa@gmail.com<br>
                <span style="font-size: 0.85em; opacity: 0.8;">Developed with ‚ù§Ô∏è for HVAC engineering community</span>
            </p>
        </div>
    </div>

    <script>
        // Global unit system
        let currentUnit = 'SI';
        
        // Unit conversion factors
        const conversions = {
            length: 3.28084,     // m to ft
            area: 10.7639,       // m¬≤ to ft¬≤
            volume: 35.3147,     // m¬≥ to ft¬≥
            airflow: 2.11888,    // L/s to CFM
            height: 3.28084      // m to ft
        };
        
        // Space types data (ASHRAE 62.1 Table 6.2.2.1) - Complete 78 space types
        const spaceTypes = {
            // üèõÔ∏è Correctional Facilities - 4 types
            cell: { 
                perPerson: 2.36, perArea: 0.61, occupantDensity: 25, combinedRate: 4.72, airClass: 2,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏∏‡∏°‡∏Ç‡∏±‡∏á‡∏ô‡∏±‡∏Å‡πÇ‡∏ó‡∏© (Cell)" 
            },
            dayroom: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 30, combinedRate: 3.30, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£ (Dayroom)" 
            },
            guard_stations: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 15, combinedRate: 4.25, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤‡∏° (Guard Stations)" 
            },
            booking_waiting: { 
                perPerson: 3.54, perArea: 0.30, occupantDensity: 50, combinedRate: 4.25, airClass: 2,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏£‡∏≠ (Booking/Waiting)" 
            },
            
            // üìö Educational Facilities - 14 types
            daycare_age4: { 
                perPerson: 4.72, perArea: 0.91, occupantDensity: 25, combinedRate: 8.03, airClass: 2,
                description: "‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πá‡∏Å ‡∏≠‡∏≤‡∏¢‡∏∏ 4 ‡∏Ç‡∏ß‡∏ö (Daycare through age 4)" 
            },
            daycare_sickroom: { 
                perPerson: 4.72, perArea: 0.91, occupantDensity: 25, combinedRate: 8.03, airClass: 3,
                description: "‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏î‡πá‡∏Å‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πá‡∏Å (Daycare Sickroom)" 
            },
            classroom_age5to8: { 
                perPerson: 4.72, perArea: 0.61, occupantDensity: 25, combinedRate: 7.08, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏≠‡∏≤‡∏¢‡∏∏ 5-8 ‡∏õ‡∏µ (Classrooms ages 5-8)" 
            },
            classroom_age9plus: { 
                perPerson: 4.72, perArea: 0.61, occupantDensity: 35, combinedRate: 6.14, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏≠‡∏≤‡∏¢‡∏∏‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà 9 ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ (Classrooms age 9 plus)" 
            },
            lecture_classroom: { 
                perPerson: 3.54, perArea: 0.30, occupantDensity: 65, combinedRate: 3.78, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà (Lecture Classroom)" 
            },
            lecture_hall_fixed: { 
                perPerson: 3.54, perArea: 0.30, occupantDensity: 150, combinedRate: 3.78, airClass: 1,
                description: "‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà (Lecture Hall Fixed Seats)" 
            },
            art_classroom: { 
                perPerson: 4.72, perArea: 0.91, occupantDensity: 20, combinedRate: 8.97, airClass: 2,
                description: "‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏®‡∏¥‡∏•‡∏õ‡∏∞ (Art Classroom)" 
            },
            science_laboratories: { 
                perPerson: 4.72, perArea: 0.91, occupantDensity: 25, combinedRate: 8.03, airClass: 2,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå (Science Laboratories)" 
            },
            university_laboratories: { 
                perPerson: 4.72, perArea: 0.91, occupantDensity: 25, combinedRate: 8.03, airClass: 2,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢ (University/College Laboratories)" 
            },
            wood_metal_shop: { 
                perPerson: 4.72, perArea: 0.91, occupantDensity: 20, combinedRate: 8.97, airClass: 2,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≤‡∏á‡πÑ‡∏°‡πâ‡πÇ‡∏•‡∏´‡∏∞ (Wood/Metal Shop)" 
            },
            computer_lab: { 
                perPerson: 4.72, perArea: 0.61, occupantDensity: 25, combinedRate: 7.08, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå (Computer Lab)" 
            },
            media_center: { 
                perPerson: 4.72, perArea: 0.61, occupantDensity: 25, combinedRate: 7.08, airClass: 1,
                description: "‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏∑‡πà‡∏≠ (Media Center)" 
            },
            music_theater_dance: { 
                perPerson: 4.72, perArea: 0.30, occupantDensity: 35, combinedRate: 5.66, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏î‡∏ô‡∏ï‡∏£‡∏µ/‡∏•‡∏∞‡∏Ñ‡∏£/‡πÄ‡∏ï‡πâ‡∏ô‡∏£‡∏≥ (Music/Theater/Dance)" 
            },
            multiuse_assembly: { 
                perPerson: 3.54, perArea: 0.30, occupantDensity: 100, combinedRate: 3.78, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡πÄ‡∏ô‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå (Multipurpose Assembly)" 
            },
            
            // üçΩÔ∏è Food and Beverage Service - 4 types
            restaurant_dining: { 
                perPerson: 3.54, perArea: 0.91, occupantDensity: 70, combinedRate: 4.72, airClass: 2,
                description: "‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡πà‡∏á‡∏Å‡∏¥‡∏ô (Restaurant Dining Rooms)" 
            },
            cafeteria_fastfood: { 
                perPerson: 3.54, perArea: 0.91, occupantDensity: 100, combinedRate: 4.25, airClass: 2,
                description: "‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£/‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏£‡πá‡∏ß (Cafeteria/Fast-food Dining)" 
            },
            bars_cocktail_lounges: { 
                perPerson: 3.54, perArea: 0.91, occupantDensity: 100, combinedRate: 4.25, airClass: 2,
                description: "‡∏ö‡∏≤‡∏£‡πå ‡∏ú‡∏±‡∏ö ‡πÄ‡∏•‡∏≤‡∏ô‡πå‡∏à (Bars, Cocktail Lounges)" 
            },
            kitchen_cooking: { 
                perPerson: 3.54, perArea: 0.61, occupantDensity: 20, combinedRate: 6.61, airClass: 2,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ß (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£) (Kitchen Cooking)" 
            },
            
            // üèóÔ∏è General - 5 types
            break_rooms: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 25, combinedRate: 3.30, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô (Break Rooms)" 
            },
            coffee_stations: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 20, combinedRate: 3.78, airClass: 1,
                description: "‡∏°‡∏∏‡∏°‡∏Å‡∏≤‡πÅ‡∏ü (Coffee Stations)" 
            },
            conference_meeting: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 50, combinedRate: 2.83, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏±‡∏°‡∏°‡∏ô‡∏≤/‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° (Conference/Meeting)" 
            },
            corridors: { 
                perPerson: 0, perArea: 0.30, occupantDensity: 0, combinedRate: 0, airClass: 1,
                description: "‡πÇ‡∏ñ‡∏á‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô (Corridors)" 
            },
            occupable_storage_liquids: { 
                perPerson: 2.36, perArea: 0.61, occupantDensity: 2, combinedRate: 30.69, airClass: 2,
                description: "‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏à‡∏• (Occupable Storage Rooms for Liquids or Gels)" 
            },
            
            // üè® Hotels, Motels, Resorts, Dormitories - 6 types
            bedroom_living_room: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 10, combinedRate: 5.19, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô/‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏±‡πà‡∏á‡πÄ‡∏•‡πà‡∏ô (Bedroom/Living Room)" 
            },
            barracks_sleeping: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 20, combinedRate: 3.78, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô‡∏£‡∏ß‡∏° (Barracks Sleeping Areas)" 
            },
            laundry_rooms_central: { 
                perPerson: 2.36, perArea: 0.61, occupantDensity: 10, combinedRate: 8.03, airClass: 2,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏ã‡∏±‡∏Å‡∏£‡∏µ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á (Laundry Rooms, Central)" 
            },
            laundry_rooms_dwelling: { 
                perPerson: 2.36, perArea: 0.61, occupantDensity: 10, combinedRate: 8.03, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏ã‡∏±‡∏Å‡∏£‡∏µ‡∏î‡πÉ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å‡∏≠‡∏≤‡∏®‡∏±‡∏¢ (Laundry Rooms within Dwelling Units)" 
            },
            lobbies_prefunction: { 
                perPerson: 3.54, perArea: 0.30, occupantDensity: 30, combinedRate: 4.72, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏ñ‡∏á‡∏£‡∏±‡∏ö‡πÅ‡∏Ç‡∏Å/‡∏´‡πâ‡∏≠‡∏á‡∏£‡∏≠ (Lobbies/Prefunction)" 
            },
            multipurpose_assembly: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 120, combinedRate: 2.83, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡πÄ‡∏ô‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå (Multipurpose Assembly)" 
            },
            
            // üè¢ Office Buildings - 6 types
            breakrooms_office: { 
                perPerson: 2.36, perArea: 0.61, occupantDensity: 50, combinedRate: 3.30, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å‡πÉ‡∏ô‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (Breakrooms)" 
            },
            main_entry_lobbies: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 10, combinedRate: 5.19, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏ñ‡∏á‡∏ó‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å (Main Entry Lobbies)" 
            },
            occupable_storage_dry: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 2, combinedRate: 16.51, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡πÅ‡∏´‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Occupable Storage Rooms for Dry Materials)" 
            },
            office_space: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 5, combinedRate: 8.03, airClass: 1,
                description: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (Office Space)" 
            },
            reception_areas: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 30, combinedRate: 3.30, airClass: 1,
                description: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÅ‡∏Ç‡∏Å‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö (Reception Areas)" 
            },
            telephone_data_entry: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 60, combinedRate: 2.83, airClass: 1,
                description: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå/‡∏õ‡πâ‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Telephone/Data Entry)" 
            },
            
            // üîß Miscellaneous Spaces - 12 types
            bank_vaults: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 5, combinedRate: 8.03, airClass: 2,
                description: "‡∏ï‡∏π‡πâ‡∏ô‡∏¥‡∏£‡∏†‡∏±‡∏¢‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ (Bank Vaults/Safe Deposit)" 
            },
            banks_lobbies: { 
                perPerson: 3.54, perArea: 0.30, occupantDensity: 15, combinedRate: 5.66, airClass: 1,
                description: "‡πÇ‡∏ñ‡∏á‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ (Banks or Bank Lobbies)" 
            },
            computer_not_printing: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 4, combinedRate: 9.44, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå) (Computer Not Printing)" 
            },
            freezer_refrigerated: { 
                perPerson: 4.72, perArea: 0, occupantDensity: 0, combinedRate: 0, airClass: 2,
                description: "‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏ä‡πà‡πÅ‡∏Ç‡πá‡∏á (<10¬∞ C) (Freezer and Refrigerated Spaces)" 
            },
            general_manufacturing: { 
                perPerson: 4.72, perArea: 0.91, occupantDensity: 7, combinedRate: 17.00, airClass: 3,
                description: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (General Manufacturing)" 
            },
            pharmacy_prep: { 
                perPerson: 2.36, perArea: 0.91, occupantDensity: 10, combinedRate: 10.85, airClass: 2,
                description: "‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏° (‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏¢‡∏≤) (Pharmacy Prep Area)" 
            },
            photo_studios: { 
                perPerson: 2.36, perArea: 0.61, occupantDensity: 10, combinedRate: 8.03, airClass: 1,
                description: "‡∏™‡∏ï‡∏π‡∏î‡∏¥‡πÇ‡∏≠‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û (Photo Studios)" 
            },
            shipping_receiving: { 
                perPerson: 4.72, perArea: 0.61, occupantDensity: 2, combinedRate: 33.02, airClass: 2,
                description: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Shipping/Receiving)" 
            },
            sorting_packing: { 
                perPerson: 3.54, perArea: 0.61, occupantDensity: 7, combinedRate: 11.81, airClass: 2,
                description: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å ‡∏ö‡∏£‡∏£‡∏à‡∏∏ ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö (Sorting, Packing, Light Assembly)" 
            },
            telephone_closets: { 
                perPerson: 0, perArea: 0, occupantDensity: 0, combinedRate: 0, airClass: 1,
                description: "‡∏ï‡∏π‡πâ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (Telephone Closets)" 
            },
            transportation_waiting: { 
                perPerson: 3.54, perArea: 0.30, occupantDensity: 100, combinedRate: 3.78, airClass: 1,
                description: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á (Transportation Waiting)" 
            },
            warehouses: { 
                perPerson: 4.72, perArea: 0.30, occupantDensity: 0, combinedRate: 0, airClass: 2,
                description: "‡πÇ‡∏Å‡∏î‡∏±‡∏á (Warehouses)" 
            },
            
            // üé≠ Public Assembly Spaces - 8 types
            auditorium_seating: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 150, combinedRate: 2.36, airClass: 1,
                description: "‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡∏°‡∏µ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î (Auditorium Seating Area)" 
            },
            places_religious_worship: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 120, combinedRate: 2.83, airClass: 1,
                description: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏®‡∏≤‡∏™‡∏ô‡∏Å‡∏¥‡∏à (Places of Religious Worship)" 
            },
            courtrooms: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 70, combinedRate: 2.83, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Ñ‡∏î‡∏µ (Courtrooms)" 
            },
            legislative_chambers: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 50, combinedRate: 2.83, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥ (Legislative Chambers)" 
            },
            libraries: { 
                perPerson: 2.36, perArea: 0.61, occupantDensity: 10, combinedRate: 8.03, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î (Libraries)" 
            },
            lobbies_public: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 150, combinedRate: 2.36, airClass: 1,
                description: "‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏ñ‡∏á‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞ (Lobbies)" 
            },
            museums_children: { 
                perPerson: 3.54, perArea: 0.61, occupantDensity: 40, combinedRate: 5.19, airClass: 1,
                description: "‡∏û‡∏¥‡∏û‡∏¥‡∏ò‡∏†‡∏±‡∏ì‡∏ë‡πå (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡πá‡∏Å) (Museums Children's)" 
            },
            museums_galleries: { 
                perPerson: 3.54, perArea: 0.30, occupantDensity: 40, combinedRate: 4.25, airClass: 1,
                description: "‡∏û‡∏¥‡∏û‡∏¥‡∏ò‡∏†‡∏±‡∏ì‡∏ë‡πå/‡∏´‡∏≠‡∏®‡∏¥‡∏•‡∏õ‡πå (Museums/Galleries)" 
            },
            
            // üè† Residential - 2 types
            dwelling_unit: { 
                perPerson: 2.36, perArea: 0.30, occupantDensity: 0, combinedRate: 0, airClass: 1,
                description: "‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢ (Dwelling Unit)" 
            },
            common_corridors: { 
                perPerson: 0, perArea: 0.30, occupantDensity: 0, combinedRate: 0, airClass: 1,
                description: "‡πÇ‡∏ñ‡∏á‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡πà‡∏ß‡∏° (Common Corridors)" 
            },
            
            // üõçÔ∏è Retail - 8 types
            sales_except_below: { 
                perPerson: 3.54, perArea: 0.61, occupantDensity: 15, combinedRate: 7.56, airClass: 2,
                description: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏•‡πà‡∏≤‡∏á) (Sales Except as Below)" 
            },
            mall_common_areas: { 
                perPerson: 3.54, perArea: 0.30, occupantDensity: 40, combinedRate: 4.25, airClass: 1,
                description: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏´‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏û‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Mall Common Areas)" 
            },
            barbershop: { 
                perPerson: 3.54, perArea: 0.30, occupantDensity: 25, combinedRate: 4.72, airClass: 2,
                description: "‡∏£‡πâ‡∏≤‡∏ô‡∏ï‡∏±‡∏î‡∏ú‡∏° (Barbershop)" 
            },
            beauty_nail_salons: { 
                perPerson: 9.44, perArea: 0.61, occupantDensity: 25, combinedRate: 11.81, airClass: 2,
                description: "‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏ß‡∏¢‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÄ‡∏•‡πá‡∏ö (Beauty and Nail Salons)" 
            },
            pet_shops: { 
                perPerson: 3.54, perArea: 0.91, occupantDensity: 10, combinedRate: 12.28, airClass: 2,
                description: "‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á (Pet Shops Animal Areas)" 
            },
            supermarket: { 
                perPerson: 3.54, perArea: 0.30, occupantDensity: 8, combinedRate: 7.08, airClass: 1,
                description: "‡∏ã‡∏∏‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡∏°‡∏≤‡∏£‡πå‡πÄ‡∏Å‡πá‡∏ï (Supermarket)" 
            },
            coin_operated_laundries: { 
                perPerson: 3.54, perArea: 0.61, occupantDensity: 20, combinedRate: 6.61, airClass: 2,
                description: "‡∏£‡πâ‡∏≤‡∏ô‡∏ã‡∏±‡∏Å‡∏ú‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏´‡∏¢‡∏≠‡∏î‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç (Coin-operated Laundries)" 
            },
            
            // üèÉ‚Äç‚ôÇÔ∏è Sports and Entertainment - 10 types
            gym_sports_arena: { 
                perPerson: 9.44, perArea: 0.91, occupantDensity: 7, combinedRate: 21.25, airClass: 2,
                description: "‡∏´‡πâ‡∏≠‡∏á‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢, ‡∏™‡∏ô‡∏≤‡∏°‡∏Å‡∏µ‡∏¨‡∏≤ (Gym, Sports Arena Play Area)" 
            },
            spectator_area: { 
                perPerson: 3.54, perArea: 0.30, occupantDensity: 150, combinedRate: 3.78, airClass: 1,
                description: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡∏ä‡∏°‡∏ú‡∏π‡πâ‡∏ä‡∏° (Spectator Area)" 
            },
            swimming_pool_deck: { 
                perPerson: 0, perArea: 2.44, occupantDensity: 0, combinedRate: 0, airClass: 2,
                description: "‡∏™‡∏£‡∏∞‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô‡πÄ‡∏î‡∏Å (Swimming Pool & Deck)" 
            },
            disco_dance_floors: { 
                perPerson: 9.44, perArea: 0.30, occupantDensity: 100, combinedRate: 9.91, airClass: 2,
                description: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡πâ‡∏ô‡∏£‡∏≥‡πÉ‡∏ô‡∏î‡∏¥‡∏™‡πÇ‡∏Å‡πâ (Disco/Dance Floors)" 
            },
            health_club_aerobics: { 
                perPerson: 9.44, perArea: 0.30, occupantDensity: 40, combinedRate: 10.38, airClass: 2,
                description: "‡πÄ‡∏Æ‡∏•‡∏ó‡πå‡∏Ñ‡∏•‡∏±‡∏ö ‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏≠‡πÇ‡∏£‡∏ö‡∏¥‡∏Ñ (Health Club/Aerobics Room)" 
            },
            health_club_weight_rooms: { 
                perPerson: 9.44, perArea: 0.30, occupantDensity: 10, combinedRate: 12.28, airClass: 2,
                description: "‡πÄ‡∏Æ‡∏•‡∏ó‡πå‡∏Ñ‡∏•‡∏±‡∏ö ‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏Å‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (Health Club/Weight Rooms)" 
            },
            bowling_alley_seating: { 
                perPerson: 4.72, perArea: 0.61, occupantDensity: 40, combinedRate: 6.14, airClass: 1,
                description: "‡πÇ‡∏ö‡∏ß‡πå‡∏•‡∏¥‡πà‡∏á (‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á) (Bowling Alley Seating)" 
            },
            gambling_casinos: { 
                perPerson: 3.54, perArea: 0.91, occupantDensity: 120, combinedRate: 4.25, airClass: 1,
                description: "‡∏Ñ‡∏≤‡∏™‡∏¥‡πÇ‡∏ô (Gambling Casinos)" 
            },
            game_arcades: { 
                perPerson: 3.54, perArea: 0.91, occupantDensity: 20, combinedRate: 8.03, airClass: 1,
                description: "‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏Å‡∏° (Game Arcades)" 
            },
            stages_studios: { 
                perPerson: 4.72, perArea: 0.30, occupantDensity: 70, combinedRate: 5.19, airClass: 1,
                description: "‡πÄ‡∏ß‡∏ó‡∏µ‡πÅ‡∏•‡∏∞‡∏™‡∏ï‡∏π‡∏î‡∏¥‡πÇ‡∏≠ (Stages, Studios)" 
            }
        };
       
        // Metabolic rates by activity level (met units)
        const activityLevels = {
            sedentary: 1.0,       // ‡∏ô‡∏±‡πà‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (1.0 met)
            light: 1.2,           // ‡∏á‡∏≤‡∏ô‡πÄ‡∏ö‡∏≤ (1.2 met)
            moderate: 2.0,        // ‡∏á‡∏≤‡∏ô‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á (2.0 met)
            heavy: 3.0            // ‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏Å (3.0 met)
        };
        
        // Helper function to set target CO2 values
        function setTargetCO2(value) {
            document.getElementById('targetCO2').value = value;
        }
        
        // Toggle between SI and I-P units
        function toggleUnit(unit) {
            currentUnit = unit;
            
            // Update button states
            document.getElementById('siBtn').classList.toggle('active', unit === 'SI');
            document.getElementById('ipBtn').classList.toggle('active', unit === 'IP');
            
            // Update all unit labels
            updateUnitLabels();
            
            // Convert existing values
            convertInputValues();
        }
        
        function updateUnitLabels() {
            if (currentUnit === 'SI') {
                // SI units
                document.getElementById('widthUnit').textContent = 'm';
                document.getElementById('lengthUnit').textContent = 'm';
                document.getElementById('areaUnit').textContent = 'm¬≤';
                document.getElementById('heightUnit').textContent = 'm';
                document.getElementById('resultOAUnit').textContent = 'L/s';
                document.getElementById('rpUnit').textContent = 'L/s';
                document.getElementById('raUnit').textContent = 'L/s';
                document.getElementById('totalReqUnit').textContent = 'L/s';
                document.getElementById('dcvOAUnit').textContent = 'L/s';
                document.getElementById('volumeUnit').textContent = 'm¬≥';
                document.getElementById('densityUnit').textContent = 'm¬≤/person';
                document.getElementById('rangeUnit').textContent = 'L/s';
            } else {
                // I-P units
                document.getElementById('widthUnit').textContent = 'ft';
                document.getElementById('lengthUnit').textContent = 'ft';
                document.getElementById('areaUnit').textContent = 'ft¬≤';
                document.getElementById('heightUnit').textContent = 'ft';
                document.getElementById('resultOAUnit').textContent = 'CFM';
                document.getElementById('rpUnit').textContent = 'CFM';
                document.getElementById('raUnit').textContent = 'CFM';
                document.getElementById('totalReqUnit').textContent = 'CFM';
                document.getElementById('dcvOAUnit').textContent = 'CFM';
                document.getElementById('volumeUnit').textContent = 'ft¬≥';
                document.getElementById('densityUnit').textContent = 'ft¬≤/person';
                document.getElementById('rangeUnit').textContent = 'CFM';
            }
        }
        
        function convertInputValues() {
            const widthInput = document.getElementById('width');
            const lengthInput = document.getElementById('length');
            const heightInput = document.getElementById('ceilingHeight');
            
            if (currentUnit === 'IP') {
                // Convert SI to I-P
                widthInput.value = (parseFloat(widthInput.value) * conversions.length).toFixed(1);
                lengthInput.value = (parseFloat(lengthInput.value) * conversions.length).toFixed(1);
                heightInput.value = (parseFloat(heightInput.value) * conversions.height).toFixed(1);
                
                // Update step values for I-P
                widthInput.step = "0.5";
                lengthInput.step = "0.5";
                heightInput.step = "0.5";
            } else {
                // Convert I-P to SI
                widthInput.value = (parseFloat(widthInput.value) / conversions.length).toFixed(1);
                lengthInput.value = (parseFloat(lengthInput.value) / conversions.length).toFixed(1);
                heightInput.value = (parseFloat(heightInput.value) / conversions.height).toFixed(1);
                
                // Restore step values for SI
                widthInput.step = "0.1";
                lengthInput.step = "0.1";
                heightInput.step = "0.1";
            }
            
            updateArea();
        }
        
        function updateOccupantDensityGuide() {
            const spaceType = document.getElementById('spaceType').value;
            const spaceData = spaceTypes[spaceType];
            const area = parseFloat(document.getElementById('calculatedArea').value) || 100;
            
            // Update recommended density
            document.getElementById('recommendedDensity').textContent = spaceData.occupantDensity + ' ‡∏Ñ‡∏ô/100m¬≤';
            
            // Calculate suggested occupancy for current area
            let suggestedOccupancy;
            if (currentUnit === 'SI') {
                suggestedOccupancy = Math.round((area * spaceData.occupantDensity) / 100);
                document.getElementById('currentSpaceType').textContent = area.toFixed(1) + ' m¬≤';
            } else {
                // Convert area back to m¬≤ for calculation
                const areaInM2 = area / conversions.area;
                suggestedOccupancy = Math.round((areaInM2 * spaceData.occupantDensity) / 100);
                document.getElementById('currentSpaceType').textContent = area.toFixed(0) + ' ft¬≤';
            }
            
            document.getElementById('suggestedOccupancy').textContent = suggestedOccupancy + ' ‡∏Ñ‡∏ô';
        }
        
        function updateArea() {
            const width = parseFloat(document.getElementById('width').value) || 0;
            const length = parseFloat(document.getElementById('length').value) || 0;
            let area = width * length;
            
            // Display area in current units
            if (currentUnit === 'SI') {
                document.getElementById('calculatedArea').value = area.toFixed(1);
            } else {
                document.getElementById('calculatedArea').value = area.toFixed(0);
            }
            
            // Update occupant density guide
            updateOccupantDensityGuide();
        }
        
        function calculate() {
            // Get input values
            const spaceType = document.getElementById('spaceType').value;
            let width = parseFloat(document.getElementById('width').value);
            let length = parseFloat(document.getElementById('length').value);
            let ceilingHeight = parseFloat(document.getElementById('ceilingHeight').value);
            const occupancy = parseInt(document.getElementById('occupancy').value);
            const targetCO2 = parseFloat(document.getElementById('targetCO2').value);
            const outdoorCO2 = parseFloat(document.getElementById('outdoorCO2').value);
            const ventilationEff = parseFloat(document.getElementById('ventilationEff').value);
            const activityLevel = document.getElementById('activityLevel').value;
            const enableDCV = document.getElementById('enableDCV').checked;
            
            // Convert I-P to SI for calculations (calculations are always in SI)
            if (currentUnit === 'IP') {
                width = width / conversions.length;
                length = length / conversions.length;
                ceilingHeight = ceilingHeight / conversions.height;
            }
            
            // Calculate in SI units
            const floorArea = width * length; // m¬≤
            const roomVolume = floorArea * ceilingHeight; // m¬≥
            
            // Calculate ASHRAE 62.1 requirements
            const spaceData = spaceTypes[spaceType];
            const rpComponent = occupancy * spaceData.perPerson; // People component (L/s)
            const raComponent = floorArea * spaceData.perArea;   // Area component (L/s)
            const ashrae621RequiredOA = rpComponent + raComponent;   // Total ASHRAE 62.1 requirement (L/s)
            
            // Design OA Rate = ASHRAE 62.1 requirement (PRIMARY)
            const designOA = ashrae621RequiredOA;
            
            // Calculate CO2 concentration using ASHRAE 62.1-2022 Appendix C formula
            // CR = COA + (8400 √ó Ez √ó m) / (Rp + Ra √ó Az/Pz)
            const metabolicRate = activityLevels[activityLevel]; // met units
            const ashrae621OARate = spaceData.perPerson + (spaceData.perArea * floorArea / occupancy); // L/s per person
            const resultingIndoorCO2 = outdoorCO2 + (8400 * ventilationEff * metabolicRate) / ashrae621OARate;
            
            // Calculate CO2-based OA requirement (for DCV analysis)
            // Rearranged from: CR = COA + (8400 √ó Ez √ó m) / (Rp + Ra √ó Az/Pz)
            // (Rp + Ra √ó Az/Pz) = (8400 √ó Ez √ó m) / (CR - COA)
            const co2BasedOAPerPerson = (8400 * ventilationEff * metabolicRate) / (targetCO2 - outdoorCO2);
            const co2BasedRequiredOA = co2BasedOAPerPerson * occupancy;
            
            // Calculate equivalent total CO2 generation for display (mL/s)
            const totalCO2Generation = (metabolicRate * occupancy * 0.00463); // Convert met to L/s CO2 per person
            
            // Calculate air changes per hour
            const airChangesPerHour = (designOA * 3.6) / roomVolume;
            
            // Calculate occupancy density
            const occupancyDensity = floorArea / occupancy;
            
            // Convert results to display units
            let displayValues = {
                rpComponent: rpComponent,
                raComponent: raComponent,
                ashrae621RequiredOA: ashrae621RequiredOA,
                co2BasedRequiredOA: co2BasedRequiredOA,
                designOA: designOA,
                roomVolume: roomVolume,
                occupancyDensity: occupancyDensity
            };
            
            if (currentUnit === 'IP') {
                displayValues.rpComponent *= conversions.airflow;
                displayValues.raComponent *= conversions.airflow;
                displayValues.ashrae621RequiredOA *= conversions.airflow;
                displayValues.co2BasedRequiredOA *= conversions.airflow;
                displayValues.designOA *= conversions.airflow;
                displayValues.roomVolume *= conversions.volume;
                displayValues.occupancyDensity *= conversions.area;
            }
            
            // Update ASHRAE Breakdown
            document.getElementById('rpRate').textContent = spaceData.perPerson;
            document.getElementById('raRate').textContent = spaceData.perArea;
            document.getElementById('peopleCount').textContent = occupancy;
            document.getElementById('areaSize').textContent = (currentUnit === 'SI' ? floorArea.toFixed(1) : (floorArea * conversions.area).toFixed(0));
            document.getElementById('rpValue').textContent = (displayValues.rpComponent).toFixed(1);
            document.getElementById('raValue').textContent = (displayValues.raComponent).toFixed(1);
            document.getElementById('totalRequired').textContent = Math.round(displayValues.ashrae621RequiredOA);
            
            // Update new fields
            document.getElementById('standardDensity').textContent = spaceData.occupantDensity;
            document.getElementById('combinedRate').textContent = spaceData.combinedRate.toFixed(2);
            document.getElementById('airClass').textContent = spaceData.airClass;
            
            // Update Main Design Results
            document.getElementById('designOA').textContent = Math.round(displayValues.designOA);
            document.getElementById('airChanges').textContent = airChangesPerHour.toFixed(1);
            document.getElementById('roomVolume').textContent = displayValues.roomVolume.toFixed(1);
            document.getElementById('occupancyDensity').textContent = displayValues.occupancyDensity.toFixed(1);
            
            // Update CO2 Verification Results
            document.getElementById('metabolicRate').textContent = metabolicRate.toFixed(1);
            document.getElementById('co2Generation').textContent = (totalCO2Generation * 1000).toFixed(2);
            document.getElementById('indoorCO2').textContent = Math.round(resultingIndoorCO2);
            
            // CO2 Status and IAQ Rating
            const co2StatusElement = document.getElementById('co2Status');
            const iaqRatingElement = document.getElementById('iaqRating');
            
            if (resultingIndoorCO2 <= 800) {
                co2StatusElement.textContent = "‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°";
                co2StatusElement.className = "status-indicator status-good";
                iaqRatingElement.textContent = "A+";
            } else if (resultingIndoorCO2 <= 1000) {
                co2StatusElement.textContent = "‡∏î‡∏µ";
                co2StatusElement.className = "status-indicator status-good";
                iaqRatingElement.textContent = "A";
            } else if (resultingIndoorCO2 <= 1200) {
                co2StatusElement.textContent = "‡∏û‡∏≠‡πÉ‡∏ä‡πâ";
                co2StatusElement.className = "status-indicator status-warning";
                iaqRatingElement.textContent = "B";
            } else {
                co2StatusElement.textContent = "‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á";
                co2StatusElement.className = "status-indicator status-poor";
                iaqRatingElement.textContent = "C";
            }
            
            // DCV Recommendation
            const dcvRecommendationElement = document.getElementById('dcvRecommendation');
            const densityThreshold = currentUnit === 'SI' ? 10 : 100; // m¬≤/person or ft¬≤/person
            
            if (displayValues.occupancyDensity < densityThreshold || resultingIndoorCO2 > 1000) {
                dcvRecommendationElement.textContent = "‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥";
                dcvRecommendationElement.style.color = "#e67e22";
            } else {
                dcvRecommendationElement.textContent = "‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô";
                dcvRecommendationElement.style.color = "#27ae60";
            }
            
            // Update DCV Analysis (if enabled)
            if (enableDCV) {
                document.getElementById('co2BasedOA').textContent = Math.round(displayValues.co2BasedRequiredOA);
                
                // Calculate potential energy savings
                const energySavings = Math.max(0, ((displayValues.ashrae621RequiredOA - displayValues.co2BasedRequiredOA) / displayValues.ashrae621RequiredOA * 100));
                document.getElementById('energySavings').textContent = energySavings.toFixed(0);
                
                // CO2 Setpoint recommendation
                document.getElementById('co2Setpoint').textContent = targetCO2;
                
                // OA Range for DCV
                const minOA = Math.round(displayValues.co2BasedRequiredOA);
                const maxOA = Math.round(displayValues.ashrae621RequiredOA);
                document.getElementById('oaRange').textContent = `${minOA}-${maxOA}`;
                
                document.getElementById('resultsDCV').style.display = 'block';
            } else {
                document.getElementById('resultsDCV').style.display = 'none';
            }
            
            // Show results sections
            document.getElementById('resultsMain').style.display = 'block';
            document.getElementById('resultsVerification').style.display = 'block';
            document.getElementById('reportSection').style.display = 'block';
        }

        function calculateAndScroll() {
            calculate();
            document.getElementById('resultsMain').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Report Generation Functions
        function generateReport() {
            const reportContent = document.getElementById('reportContent');
            const currentDate = new Date().toLocaleDateString('th-TH', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Get current calculation data
            const spaceType = document.getElementById('spaceType').value;
            const spaceData = spaceTypes[spaceType];
            const width = parseFloat(document.getElementById('width').value);
            const length = parseFloat(document.getElementById('length').value);
            const occupancy = parseInt(document.getElementById('occupancy').value);
            const ceilingHeight = parseFloat(document.getElementById('ceilingHeight').value);
            const targetCO2 = parseFloat(document.getElementById('targetCO2').value);
            const outdoorCO2 = parseFloat(document.getElementById('outdoorCO2').value);
            const activityLevel = document.getElementById('activityLevel').value;
            const metabolicRateValue = document.getElementById('metabolicRate') ? document.getElementById('metabolicRate').textContent : '1.0';
            
            // Calculate area
            let area = width * length;
            if (currentUnit === 'IP') {
                // Convert back to SI for display
                area = (width / conversions.length) * (length / conversions.length);
            }
            
            const unitLabels = currentUnit === 'SI' ? 
                { length: 'm', area: 'm¬≤', airflow: 'L/s' } : 
                { length: 'ft', area: 'ft¬≤', airflow: 'CFM' };
            
            reportContent.innerHTML = `
                <div class="report-header">
                    <div class="report-title">ASHRAE 62.1 Design Analysis Report</div>
                    <div class="report-subtitle">Fresh Air Requirements & CO2 Verification</div>
                </div>
                
                <div class="report-meta">
                    <div>
                        <strong>Project Date:</strong> ${currentDate}<br>
                        <strong>Report Version:</strong> 1.1.0 LITE<br>
                        <strong>Standard:</strong> ASHRAE 62.1-2022
                    </div>
                    <div>
                        <strong>Unit System:</strong> ${currentUnit} (${currentUnit === 'SI' ? '‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å' : '‡∏≠‡∏¥‡∏°‡∏û‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏•'})<br>
                        <strong>Calculation Method:</strong> Design + Verification<br>
                        <strong>Generated By:</strong> HVAC Design Calculator
                    </div>
                </div>
                
                <div class="report-section-title">üìã Project Input Parameters</div>
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Value</th>
                            <th>Unit</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Space Type</td>
                            <td>${spaceData.description}</td>
                            <td>-</td>
                            <td>According to ASHRAE 62.1 Table 6.2.2.1</td>
                        </tr>
                        <tr>
                            <td>Occupant Density (Standard)</td>
                            <td>${spaceData.occupantDensity}</td>
                            <td>‡∏Ñ‡∏ô/100m¬≤</td>
                            <td>ASHRAE recommended density</td>
                        </tr>
                        <tr>
                            <td>Combined OA Rate</td>
                            <td>${spaceData.combinedRate.toFixed(2)}</td>
                            <td>L/s¬∑person</td>
                            <td>Total outdoor air requirement per person</td>
                        </tr>
                        <tr>
                            <td>Air Class</td>
                            <td>${spaceData.airClass}</td>
                            <td>-</td>
                            <td>Air quality classification (1=Best, 2=Standard, 3=Special)</td>
                        </tr>
                        <tr>
                            <td>Floor Area</td>
                            <td>${currentUnit === 'SI' ? area.toFixed(1) : (area * conversions.area).toFixed(0)}</td>
                            <td>${unitLabels.area}</td>
                            <td>Calculated from width √ó length</td>
                        </tr>
                        <tr>
                            <td>Occupancy</td>
                            <td>${occupancy}</td>
                            <td>persons</td>
                            <td>Design occupancy level</td>
                        </tr>
                        <tr>
                            <td>Activity Level</td>
                            <td>${activityLevel}</td>
                            <td>-</td>
                            <td>Activity level for metabolic rate</td>
                        </tr>
                        <tr>
                            <td>Metabolic Rate</td>
                            <td>${metabolicRateValue}</td>
                            <td>met</td>
                            <td>Based on activity level</td>
                        </tr>
                        <tr>
                            <td>Target CO2</td>
                            <td>${targetCO2}</td>
                            <td>ppm</td>
                            <td>Indoor air quality verification target</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="report-section-title">üéØ ASHRAE 62.1 Design Results (Primary)</div>
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>Rate</th>
                            <th>Calculation</th>
                            <th>Result</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Rp (People Component)</td>
                            <td>${spaceData.perPerson} L/s¬∑person</td>
                            <td>${occupancy} √ó ${spaceData.perPerson}</td>
                            <td>${document.getElementById('rpValue').textContent} ${currentUnit === 'SI' ? 'L/s' : 'CFM'}</td>
                        </tr>
                        <tr>
                            <td>Ra (Area Component)</td>
                            <td>${spaceData.perArea} L/s¬∑m¬≤</td>
                            <td>${area.toFixed(1)} √ó ${spaceData.perArea}</td>
                            <td>${document.getElementById('raValue').textContent} ${currentUnit === 'SI' ? 'L/s' : 'CFM'}</td>
                        </tr>
                        <tr style="background-color: #d4edda; font-weight: bold;">
                            <td><strong>Recommended OA Rate</strong></td>
                            <td>Rp + Ra</td>
                            <td>ASHRAE 62.1 Required</td>
                            <td><strong>${document.getElementById('designOA').textContent} ${unitLabels.airflow}</strong></td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="report-section-title">üîç CO2 Verification Results</div>
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Value</th>
                            <th>Unit</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Predicted Indoor CO2</td>
                            <td>${document.getElementById('indoorCO2').textContent}</td>
                            <td>ppm</td>
                            <td>${parseInt(document.getElementById('indoorCO2').textContent) <= 1000 ? '‚úÖ Good' : '‚ö†Ô∏è Review'}</td>
                        </tr>
                        <tr>
                            <td>CO2 Calculation Method</td>
                            <td>ASHRAE 62.1-2022 Appendix C</td>
                            <td>-</td>
                            <td>CR = COA + (8400 √ó Ez √ó m) / (Rp + Ra √ó Az/Pz)</td>
                        </tr>
                        <tr>
                            <td>IAQ Performance</td>
                            <td>${document.getElementById('iaqRating').textContent}</td>
                            <td>Rating</td>
                            <td>Based on CO2 levels</td>
                        </tr>
                        <tr>
                            <td>Air Changes per Hour</td>
                            <td>${document.getElementById('airChanges').textContent}</td>
                            <td>ACH</td>
                            <td>Calculated</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="report-section-title">üìù Design Summary</div>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea;">
                    <ul style="margin: 0; padding-left: 20px;">
                        <li><strong>Design Approach:</strong> ASHRAE 62.1-2022 compliance as primary design criteria</li>
                        <li><strong>CO2 Calculation:</strong> ASHRAE 62.1-2022 Appendix C Formula</li>
                        <li><strong>Metabolic Rate:</strong> ${metabolicRateValue} met (${activityLevel} activity)</li>
                        <li><strong>Occupancy Density:</strong> ${(area/occupancy).toFixed(1)} ${unitLabels.area}/person</li>
                        <li><strong>DCV Recommendation:</strong> ${document.getElementById('dcvRecommendation').textContent}</li>
                        <li><strong>Design Conclusion:</strong> ${parseInt(document.getElementById('indoorCO2').textContent) <= 1000 ? 'ASHRAE 62.1 compliance achieves target IAQ levels' : 'Consider additional ventilation measures or DCV system'}</li>
                    </ul>
                </div>
                
                <div class="watermark">
                    <div>Generated by ASHRAE 62.1 Design Calculator v1.1.0 - LITE Edition</div>
                    <div style="font-size: 0.9em; margin-top: 5px;">Professional features available in PRO version</div>
                </div>
            `;
            
            // Show modal
            document.getElementById('reportModal').style.display = 'block';
        }
        
        function closeReport() {
            document.getElementById('reportModal').style.display = 'none';
        }
        
        function showAbout() {
            document.getElementById('aboutModal').style.display = 'block';
        }
        
        function closeAbout() {
            document.getElementById('aboutModal').style.display = 'none';
        }
        
        function exportToPDF() {
            // For LITE version - show upgrade message (same as V49)
            alert('üìÑ PDF Export\n\nThis feature is available in the PRO version.\n\n‚úÖ Professional PDF reports\n‚úÖ Custom branding\n‚úÖ Multi-project management\n\nContact us to upgrade!');
        }
        
        function exportToExcel() {
            // For LITE version - create simple CSV export (same as V49)
            const data = [
                ['ASHRAE 62.1 Calculation Report - LITE Version (Updated with Thai Standards)'],
                [''],
                ['Input Parameters'],
                ['Space Type', document.getElementById('spaceType').selectedOptions[0].text],
                ['Width', document.getElementById('width').value, currentUnit === 'SI' ? 'm' : 'ft'],
                ['Length', document.getElementById('length').value, currentUnit === 'SI' ? 'm' : 'ft'],
                ['Area', document.getElementById('calculatedArea').value, currentUnit === 'SI' ? 'm¬≤' : 'ft¬≤'],
                ['Occupancy', document.getElementById('occupancy').value, 'persons'],
                ['Standard Occupant Density', document.getElementById('standardDensity').textContent, '‡∏Ñ‡∏ô/100m¬≤'],
                ['Combined OA Rate', document.getElementById('combinedRate').textContent, 'L/s¬∑person'],
                ['Air Class', document.getElementById('airClass').textContent, '-'],
                ['Ceiling Height', document.getElementById('ceilingHeight').value, currentUnit === 'SI' ? 'm' : 'ft'],
                ['Activity Level', document.getElementById('activityLevel').value],
                ['Metabolic Rate', document.getElementById('metabolicRate').textContent, 'met'],
                ['Target CO2', document.getElementById('targetCO2').value, 'ppm'],
                [''],
                ['Results (ASHRAE 62.1-2022 Appendix C Formula)'],
                ['CO2 Formula', 'CR = COA + (8400 √ó Ez √ó m) / (Rp + Ra √ó Az/Pz)'],
                ['ASHRAE 62.1 Minimum', document.getElementById('totalRequired').textContent, currentUnit === 'SI' ? 'L/s' : 'CFM'],
                ['CO2-based Minimum', (document.getElementById('co2BasedOA') ? document.getElementById('co2BasedOA').textContent : 'N/A'), currentUnit === 'SI' ? 'L/s' : 'CFM'],
                ['Recommended OA', (document.getElementById('designOA') ? document.getElementById('designOA').textContent : document.getElementById('totalRequired').textContent), currentUnit === 'SI' ? 'L/s' : 'CFM'],
                ['Resulting CO2', (document.getElementById('indoorCO2') ? document.getElementById('indoorCO2').textContent : 'N/A'), 'ppm'],
                ['Air Changes/Hour', (document.getElementById('airChanges') ? document.getElementById('airChanges').textContent : 'N/A'), 'ACH'],
                [''],
                ['Generated by HVAC Calculator LITE v1.1.0 - Updated Thai Standards']
            ];
            
            let csvContent = data.map(row => row.join(',')).join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('hidden', '');
            a.setAttribute('href', url);
            a.setAttribute('download', 'HVAC_Calculation_Report.csv');
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            alert('üìà Excel Export (CSV)\n\nBasic CSV export completed!\n\nPRO version includes:\n‚úÖ Full Excel formatting\n‚úÖ Charts & graphs\n‚úÖ Multiple sheets\n‚úÖ Formulas & calculations');
        }
        
        function exportToWord() {
            // For LITE version - create simple text export (same as V49)
            const reportContent = document.getElementById('reportContent').innerText;
            const blob = new Blob([reportContent], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('hidden', '');
            a.setAttribute('href', url);
            a.setAttribute('download', 'HVAC_Report.txt');
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            alert('üìù Word Export (Text)\n\nBasic text export completed!\n\nPRO version includes:\n‚úÖ Professional Word formatting\n‚úÖ Company letterhead\n‚úÖ Technical diagrams\n‚úÖ Calculation appendix');
        }
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            const reportModal = document.getElementById('reportModal');
            const aboutModal = document.getElementById('aboutModal');
            
            if (event.target === reportModal) {
                closeReport();
            }
            if (event.target === aboutModal) {
                closeAbout();
            }
        }
        
        // Initialize page
        window.onload = function() {
            updateUnitLabels();
            updateArea();
            updateOccupantDensityGuide();
            
            // Update area/guide only on input changes
            document.getElementById('width').addEventListener('input', updateArea);
            document.getElementById('length').addEventListener('input', updateArea);
            document.getElementById('occupancy').addEventListener('input', updateOccupantDensityGuide);
            document.getElementById('spaceType').addEventListener('change', updateOccupantDensityGuide);
            
            // All calculations and scrolling are now handled by the button click
            document.querySelector('.calculate-btn').addEventListener('click', calculateAndScroll);
        };
    </script>
</body>
</html>
